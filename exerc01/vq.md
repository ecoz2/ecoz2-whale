# VQ based classification

See [vq.sh](vq.sh).

Training phase not captured below, only the classification steps.

## TODO 

Examine codebook generation.
For example, both
[data/codebooks/B/eps_0.0005.rpt](data/codebooks/B/eps_0.0005.rpt),
a pretty bad case,
and
[data/codebooks/C1/eps_0.0005.rpt](data/codebooks/C1/eps_0.0005.rpt),
a pretty good one,
have many empty cells. Probaly OK but worth closer examination.

```
$ ecoz2 vq classify --codebooks data/codebooks/[A-Z]*/eps_0.0005_M_1024.cbook --predictors data/predictors/TRAIN
number of codebooks: 20  number of predictors: 4296
show_ranked = false

Loading models:
 0: data/codebooks/A/eps_0.0005_M_1024.cbook
 1: data/codebooks/B/eps_0.0005_M_1024.cbook
 2: data/codebooks/Bd/eps_0.0005_M_1024.cbook
 3: data/codebooks/Bm/eps_0.0005_M_1024.cbook
 4: data/codebooks/Bu/eps_0.0005_M_1024.cbook
 5: data/codebooks/C/eps_0.0005_M_1024.cbook
 6: data/codebooks/C1/eps_0.0005_M_1024.cbook
 7: data/codebooks/D/eps_0.0005_M_1024.cbook
 8: data/codebooks/E/eps_0.0005_M_1024.cbook
 9: data/codebooks/E1/eps_0.0005_M_1024.cbook
10: data/codebooks/F/eps_0.0005_M_1024.cbook
11: data/codebooks/G/eps_0.0005_M_1024.cbook
12: data/codebooks/G2/eps_0.0005_M_1024.cbook
13: data/codebooks/H/eps_0.0005_M_1024.cbook
14: data/codebooks/I/eps_0.0005_M_1024.cbook
15: data/codebooks/I2/eps_0.0005_M_1024.cbook
16: data/codebooks/I3/eps_0.0005_M_1024.cbook
17: data/codebooks/I4/eps_0.0005_M_1024.cbook
18: data/codebooks/M/eps_0.0005_M_1024.cbook
19: data/codebooks/P/eps_0.0005_M_1024.cbook

******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************_*********************************_*********************************************************************************************************************************************************************************************_****************************************************************************************************************************************_****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************

     Confusion matrix:
            0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18  19     tests   errors

   A   0  410   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0      410       0
   B   1    0  11   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0       11       0
  Bd   2    0   0  41   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0       41       0
  Bm   3    0   0   0 482   0   0   0   0   0   0   0   0   0   1   0   1   1   0   0   1      486       4
  Bu   4    0   0   0   0  35   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0       35       0
   C   5    0   0   0   0   0 441   0   0   0   0   0   0   0   0   0   0   0   0   0   0      441       0
  C1   6    0   0   0   0   0   0  13   0   0   0   0   0   0   0   0   0   0   0   0   0       13       0
   D   7    0   0   0   0   0   0   0 141   0   0   0   0   0   0   0   0   0   0   0   0      141       0
   E   8    0   0   0   0   0   0   0   0 571   0   0   0   0   0   0   0   0   0   0   0      571       0
  E1   9    0   0   0   0   0   0   0   0   0  22   0   0   0   0   0   0   0   0   0   0       22       0
   F  10    0   0   0   0   0   0   0   0   0   0 273   0   0   0   0   0   0   0   0   0      273       0
   G  11    0   0   0   0   0   0   0   0   0   0   0  61   0   0   0   0   0   0   0   0       61       0
  G2  12    0   0   0   0   0   0   0   0   0   0   0   0 246   0   0   0   0   0   0   0      246       0
   H  13    0   0   0   0   0   0   0   0   0   0   0   0   0 113   0   0   0   0   0   0      113       0
   I  14    0   0   0   0   0   0   0   0   0   0   0   0   0   0 377   0   0   0   0   0      377       0
  I2  15    0   0   0   0   0   0   0   0   0   0   0   0   0   0   0 572   0   0   0   0      572       0
  I3  16    0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0 260   0   0   0      260       0
  I4  17    0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0  37   0   0       37       0
   M  18    0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0  49   0       49       0
   P  19    0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0 137      137       0

     class     accuracy    tests      candidate order
   A     0      100.00%   410        410   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
   B     1      100.00%    11         11   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
  Bd     2      100.00%    41         41   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
  Bm     3       99.18%   486        482   3   0   0   0   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0
  Bu     4      100.00%    35         35   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
   C     5      100.00%   441        441   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
  C1     6      100.00%    13         13   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
   D     7      100.00%   141        141   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
   E     8      100.00%   571        571   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
  E1     9      100.00%    22         22   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
   F    10      100.00%   273        273   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
   G    11      100.00%    61         61   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
  G2    12      100.00%   246        246   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
   H    13      100.00%   113        113   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
   I    14      100.00%   377        377   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
  I2    15      100.00%   572        572   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
  I3    16      100.00%   260        260   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
  I4    17      100.00%    37         37   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
   M    18      100.00%    49         49   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
   P    19      100.00%   137        137   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0

       TOTAL     99.91%   4296        4292   3   0   0   0   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0




$ ecoz2 vq classify --codebooks data/codebooks/[A-Z]*/eps_0.0005_M_1024.cbook --predictors data/predictors/TEST
number of codebooks: 20  number of predictors: 1060
show_ranked = false

Loading models:
 0: data/codebooks/A/eps_0.0005_M_1024.cbook
 1: data/codebooks/B/eps_0.0005_M_1024.cbook
 2: data/codebooks/Bd/eps_0.0005_M_1024.cbook
 3: data/codebooks/Bm/eps_0.0005_M_1024.cbook
 4: data/codebooks/Bu/eps_0.0005_M_1024.cbook
 5: data/codebooks/C/eps_0.0005_M_1024.cbook
 6: data/codebooks/C1/eps_0.0005_M_1024.cbook
 7: data/codebooks/D/eps_0.0005_M_1024.cbook
 8: data/codebooks/E/eps_0.0005_M_1024.cbook
 9: data/codebooks/E1/eps_0.0005_M_1024.cbook
10: data/codebooks/F/eps_0.0005_M_1024.cbook
11: data/codebooks/G/eps_0.0005_M_1024.cbook
12: data/codebooks/G2/eps_0.0005_M_1024.cbook
13: data/codebooks/H/eps_0.0005_M_1024.cbook
14: data/codebooks/I/eps_0.0005_M_1024.cbook
15: data/codebooks/I2/eps_0.0005_M_1024.cbook
16: data/codebooks/I3/eps_0.0005_M_1024.cbook
17: data/codebooks/I4/eps_0.0005_M_1024.cbook
18: data/codebooks/M/eps_0.0005_M_1024.cbook
19: data/codebooks/P/eps_0.0005_M_1024.cbook

***********************************************************************************************_******_____**_____*******_*_**_**_********_******************_******_****_*_*_*_*****___***_**************_*********_*************___**_*____*_____**_*********_**__*************_*****_**_**_****_***********************_*********__***********_*_**********************_*_*******_*_*********_**_**_*__*****_************__*******__********************************************_********************************************_**********_*_****_**_**********************_********************_************************__******__****_********************_**_*******_*********_***********************************************___*******__*****__********_*****_*_********_*_*****____***__*__**_*___******_*********************************_*****************_****_*******_*****_*******_***_****_***_*********_****_******************************_********__***_*__*********_**_*__***__***_***********__*_***_********************_**__***_*___******_*_********_*****__*********_***_***__

     Confusion matrix:
            0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18  19     tests   errors

   A   0  101   0   0   0   0   0   0   0   0   0   0   0   0   0   1   0   0   0   0   0      102       1
   B   1    0   0   0   2   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0        2       2
  Bd   2    0   0   2   5   0   0   0   0   0   0   0   0   0   0   0   0   1   1   0   0        9       7
  Bm   3    4   0   1  98   0   0   0   1   0   0   0   0   0   1   0   3  10   3   0   0      121      23
  Bu   4    0   0   1   6   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0        8       7
   C   5    2   0   0   0   0  94   0   2   2   0   7   0   1   0   0   0   0   0   0   1      109      15
  C1   6    0   0   0   0   0   0   3   0   0   0   0   0   0   0   0   0   0   0   0   0        3       0
   D   7    0   0   0   0   0   2   0  28   1   0   2   0   0   0   1   0   0   0   0   0       34       6
   E   8    1   0   0   0   0   3   0   4 130   0   0   0   1   0   1   0   0   0   0   2      142      12
  E1   9    0   0   0   0   0   0   0   0   2   3   0   0   0   0   0   0   0   0   0   0        5       2
   F  10    0   0   0   0   0   0   0   2   0   0  65   0   0   0   0   0   0   0   0   0       67       2
   G  11    0   0   0   0   0   0   0   0   3   0   0  10   1   0   0   0   0   0   0   1       15       5
  G2  12    0   0   0   0   0   0   0   0   4   0   0   0  57   0   0   0   0   0   0   0       61       4
   H  13    0   0   0   0   0   0   0   0   0   0   0   0   0  28   0   0   0   0   0   0       28       0
   I  14    0   0   0   0   0   1   0   0   6   0   1   0   3   0  69  14   0   0   0   0       94      25
  I2  15    0   0   0   2   0   2   0   0   6   0   0   0   1   0   4 125   1   1   0   0      142      17
  I3  16    0   0   0   3   0   0   0   0   0   0   0   0   0   1   1   4  52   3   0   0       64      12
  I4  17    0   0   1   1   0   0   0   0   0   0   0   0   0   0   0   1   2   4   0   0        9       5
   M  18    0   0   0   0   0   0   0   1   0   0   1   0   0   0   0   0   0   0   8   1       11       3
   P  19    0   0   0   0   0   1   0   1   3   0   0   1   0   0   0   1   0   0   0  27       34       7
```

For the following, report manually sorted by accuracy:

```

     class     accuracy    tests      candidate order
  C1     6      100.00%     3          3   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
   H    13      100.00%    28         28   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
   A     0       99.02%   102        101   0   0   0   0   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0
   F    10       97.01%    67         65   1   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
  G2    12       93.44%    61         57   2   2   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
   E     8       91.55%   142        130   8   3   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
  I2    15       88.03%   142        125  12   2   2   0   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0
   C     5       86.24%   109         94  10   3   1   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
   D     7       82.35%    34         28   5   0   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
  I3    16       81.25%    64         52   9   2   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
  Bm     3       80.99%   121         98   6   5   4   2   1   1   1   1   0   1   1   0   0   0   0   0   0   0   0
   P    19       79.41%    34         27   4   2   0   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
   I    14       73.40%    94         69  18   0   3   3   0   0   1   0   0   0   0   0   0   0   0   0   0   0   0
   M    18       72.73%    11          8   0   1   0   1   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0
   G    11       66.67%    15         10   2   1   1   0   0   0   0   1   0   0   0   0   0   0   0   0   0   0   0
  E1     9       60.00%     5          3   0   0   2   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
  I4    17       44.44%     9          4   1   1   2   0   0   1   0   0   0   0   0   0   0   0   0   0   0   0   0
  Bd     2       22.22%     9          2   4   0   2   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
  Bu     4       12.50%     8          1   6   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
   B     1        0.00%     2          0   0   0   0   1   0   0   0   0   0   1   0   0   0   0   0   0   0   0   0

       TOTAL     85.38%   1060        905  88  24  20  10   4   2   2   2   0   2   1   0   0   0   0   0   0   0   0
```
